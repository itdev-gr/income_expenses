---
interface KPI {
	label: string;
	income: number;
	expense: number;
	net: number;
	cash?: number;
	online?: number;
}

interface Props {
	title: string;
	data: KPI | null;
}

const { title, data } = Astro.props;

function formatCurrency(cents: number): string {
	return new Intl.NumberFormat('en-US', {
		style: 'currency',
		currency: 'EUR',
	}).format(cents / 100);
}

function getCards(kpi: KPI) {
	const cards = [
		{ label: 'Income', value: kpi.income, color: 'text-green-600' },
		{ label: 'Expense', value: kpi.expense, color: 'text-red-600' },
		{ label: 'Net', value: kpi.net, color: kpi.net >= 0 ? 'text-green-600' : 'text-red-600' },
	];

	if (kpi.cash !== undefined) {
		cards.push({ label: 'Cash', value: kpi.cash, color: 'text-green-600' });
	}
	if (kpi.online !== undefined) {
		cards.push({ label: 'Online', value: kpi.online, color: 'text-green-600' });
	}

	return cards;
}
---

<div class="mb-6">
	<h2 class="text-lg font-semibold text-gray-900 mb-4">{title}</h2>
	{data ? (
		(() => {
			const cards = getCards(data);
			const gridClass = cards.length === 5 ? 'md:grid-cols-5' : 'md:grid-cols-3';
			return (
				<div class={`grid grid-cols-1 ${gridClass} gap-4`}>
					{cards.map(card => (
						<div class="bg-white rounded-lg shadow p-6">
							<div class="text-sm text-gray-600 mb-1">{card.label}</div>
							<div class={`text-2xl font-bold ${card.color}`}>{formatCurrency(card.value)}</div>
						</div>
					))}
				</div>
			);
		})()
	) : (
		<div class="bg-white rounded-lg shadow p-6 text-center text-gray-500">
			No data available
		</div>
	)}
</div>
